<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Codesmith Github Organization Webhook GUI</title>
</head>
<body>
  <div>
    <h1>Register Organization Webhook</h1>
    <form id="create-hook">
      <input id="event-hook" type="input" />
    </form>
  </div>
  <hr />
  <div>
    <h1>List Organization Webhooks</h1>
    <form id="get-hook">
      <button>Get Hooks</button>
    </form>
    <div id="hook-list"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js"></script>

  <script>

    const createHookForm = document.querySelector("#create-hook");

    createHookForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const eventHook = document.querySelector("#event-hook");
      axios.post('/createHook', { value: eventHook.value })
      .then(data => console.log('done!'));
    });

    const getHookForm = document.querySelector('#get-hook');
    getHookForm.addEventListener('submit', (e) => {
      e.preventDefault();
      axios.get('/getHooks')
      .then(data => {

        const events = Array.from(data.data).reduce((a, c) => {
          return a.concat(c.events);
        }, []);

        events.forEach(event => {
          const element = document.createElement('p');
          element.innerHTML = event;
          document.querySelector('#hook-list').append(element);
        });
      });
    });
  </script>
</body>
</html>